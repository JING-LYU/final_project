<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Smokers’ Insurance Preference</title>

<script src="site_libs/header-attrs-2.10/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/united.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>








<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Home</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="about.html">About</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Analysis
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="exploration.html">Smokers' Insurance Preference</a>
    </li>
    <li>
      <a href="medical_cost.html">Insurance Charge Predication</a>
    </li>
  </ul>
</li>
<li>
  <a href="discussion.html">Conclusion and discussion</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Interactive tools
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="mapping.html">Mapping - Find your insurance conselting location</a>
    </li>
    <li>
      <a href="https://yiqunjin.shinyapps.io/shiny_dashboard/">Shiny Dashboard - Predicet your insurance Charge!</a>
    </li>
  </ul>
</li>
<li>
  <a href="final_report.html">Report</a>
</li>
<li>
  <a href="mailto:&lt;yw3772@cumc.columbia.com&gt;">
    <span class="fa fa-envelope fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="http://github.com/wyshanw/">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Smokers’ Insurance Preference</h1>

</div>


<pre class="r"><code>ataset_basic = read_csv(&quot;data/dataset_basic.csv&quot;)

dataset_basic = read_csv(&quot;data/dataset_basic.csv&quot;) %&gt;% 
  mutate(
         child = factor(child,levels = c(1,2),labels = c(&quot;yes&quot;,&quot;no&quot;)),
         sex = factor(sex,labels = c(&quot;male&quot;,&quot;female&quot;)),
         insure = factor(insure,levels = c(1,2,3,4,5,6,7),labels = c(&quot;Employer&quot;,&quot;Self-purchase&quot;,&quot;Medicare&quot;, &quot;Medicaid/Family Health+&quot;, &quot;Milit/CHAMPUS/Tricare&quot;, &quot;COBRA/Other&quot;, &quot;Uninsured&quot;)),
         smoker = factor(smoker,levels = c(1,2,3),labels = c(&quot;never&quot;,&quot;current&quot;,&quot;former&quot;)),
         agegroup = factor(agegroup,ordered = TRUE,labels = c(&quot;18-24yrs&quot;,&quot;25-44yrs&quot;, &quot;45-64yrs&quot;, &quot;65+yrs&quot;))
         ) %&gt;% 
  dplyr::select(insure,agegroup,smoker,bmi,child,sex)</code></pre>
<pre class="r"><code>smoke_df = read_csv(&quot;data/dataset_basic.csv&quot;) %&gt;% 
  dplyr::select(agegroup,smoker,everyday,numberperdaya,cost20cigarettes,generalhealth,poverty_group = imputed_povertygroup,bmi,child,sex) %&gt;% 
  drop_na(smoker) %&gt;% 
  mutate(
         smoker_cat = case_when(
           numberperdaya &lt;= 10 ~ 1,
           (numberperdaya &gt; 10) &amp; (numberperdaya &lt;= 20) ~2,
           numberperdaya &gt; 20 ~ 3),
         smoker_cat = factor(smoker_cat,levels = c(1,2,3),labels = c(&quot;light&quot;,&quot;normal&quot;,&quot;heavy&quot;)),
         smoker = factor(smoker,levels = c(1,2,3),labels = c(&quot;never&quot;,&quot;current&quot;,&quot;former&quot;)),
         smoker = fct_infreq(smoker),
         agegroup = factor(agegroup,ordered = TRUE,labels = c(&quot;18-24yrs&quot;,&quot;25-44yrs&quot;, &quot;45-64yrs&quot;, &quot;65+yrs&quot;)),
         generalhealth = factor(generalhealth,levels = c(5,4,3,2,1), labels = c(&quot;Poor&quot;,&quot;Fair&quot;,&quot;Good&quot;,&quot;Very good&quot;,&quot;Excellent&quot;)),
         poverty_group = factor(poverty_group,levels = c(1,2,3,4,5),labels = c(&quot;&lt;100% FPL&quot;,&quot;100 - &lt;200% FPL&quot;,&quot;200 - &lt;400% FPL&quot;,&quot;400 - &lt;600% FPL&quot;,&quot;&gt;600% FPL&quot;)),
         everyday = factor(everyday, levels = c(1,2), labels = c(&quot;everyday smoker&quot;, &quot;casual smoker&quot;))
         
         )

current_smoker = smoke_df %&gt;% filter(smoker == &quot;current&quot;)</code></pre>
<div id="knowledge-about-insurance-in-our-dataset" class="section level3">
<h3>1. Knowledge about <strong>insurance</strong> in our dataset</h3>
<ul>
<li><p>Among 2941 participants in the dataset: 2582 (88%) of them are insurance holders, while 359 (12%) of them don’t have insurance cover.</p></li>
<li><p>Most of participants have employer-sponsored health insurance (38%), other types include Medicaid/Family Health+ (24%), Medicare (20%), Uninsured (9%), Self-purchase (6%), COBRA/Other (2%) and Milit/CHAMPUS/Tricare (1%).</p></li>
<li><p>Detailed introduction on each insurance type is summarized in the below table:</p></li>
</ul>
<pre class="r"><code>insurehold = read_csv(&quot;data/dataset_basic.csv&quot;) %&gt;% 
  drop_na() %&gt;% 
  mutate(
  insuredgateway = factor(insuredgateway, levels = c(1,2), labels = c(&quot;yes&quot;, &quot;no&quot;))) %&gt;% 
  ggplot(aes(x = insuredgateway,fill = insuredgateway))+
  geom_bar()+
  theme(legend.position = &quot;none&quot;) +
  labs(
    x = &quot;Hold status of insurance&quot;,
    y = &quot;Number of participants&quot;,
    title = &quot;Holding status of insurace among participants&quot;)</code></pre>
<pre class="r"><code>insuretype = dataset_basic %&gt;% 
  drop_na() %&gt;% 
  mutate(insure = fct_infreq(insure)) %&gt;% 
  ggplot(aes(x = insure,fill = insure))+
  geom_bar()+
  theme(legend.position = &quot;none&quot;) +
  theme(plot.title = element_text(hjust = 0.5)) +
  labs(
    x = &quot;Insurance type&quot;,
    y = &quot;Number of holders&quot;,
    title = &quot;Number of holders\nin each insurance type&quot;) + 
  coord_flip()</code></pre>
<p><img src="exploration_files/figure-html/my-chunkhaha-1.png" width="90%" /></p>
<pre class="r"><code>insur_type &lt;- c(&quot;Employer&quot;, &quot;Medicare&quot;, &quot;Milit/CHAMPUS&quot;, &quot;Uninsured&quot;, &quot;Self-purchased&quot;, &quot;Medicaid/Family Health+&quot;, &quot;COBRA/other&quot;)

insur_meaning &lt;- c(&quot;Employer-sponsored health insurance is a health insurance selected and purchased by your employer and offered to eligible employees and their dependents.&quot;,
                   &quot;Medicare is federal health insurance for people 65 or older, some younger people with disabilities, people with End-Stage Renal Disease&quot;,
                   &quot;Health Care progam for military&quot;,
                   &quot;Not insured&quot;,
                   &quot;Insurance purchased by individual choice&quot;,
                   &quot;Medicaid/health insurance program for adults who are aged 19 to 64 who have income too high to qualify for Medicaid&quot;,
                   &quot;Consolidated Omnibus Budget Reconciliation Act, which gives some employees the ability to continue health insurance coverage after leaving employment, or other types of insurance.&quot;)

insur &lt;- data.frame(insur_type, insur_meaning) %&gt;% 
  dplyr::rename(
    &quot;Insurance type&quot; = insur_type,
    &quot;Insurance type meaning&quot; = insur_meaning
  )
knitr::kable(insur)</code></pre>
<table>
<colgroup>
<col width="11%" />
<col width="88%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Insurance type</th>
<th align="left">Insurance type meaning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Employer</td>
<td align="left">Employer-sponsored health insurance is a health insurance selected and purchased by your employer and offered to eligible employees and their dependents.</td>
</tr>
<tr class="even">
<td align="left">Medicare</td>
<td align="left">Medicare is federal health insurance for people 65 or older, some younger people with disabilities, people with End-Stage Renal Disease</td>
</tr>
<tr class="odd">
<td align="left">Milit/CHAMPUS</td>
<td align="left">Health Care progam for military</td>
</tr>
<tr class="even">
<td align="left">Uninsured</td>
<td align="left">Not insured</td>
</tr>
<tr class="odd">
<td align="left">Self-purchased</td>
<td align="left">Insurance purchased by individual choice</td>
</tr>
<tr class="even">
<td align="left">Medicaid/Family Health+</td>
<td align="left">Medicaid/health insurance program for adults who are aged 19 to 64 who have income too high to qualify for Medicaid</td>
</tr>
<tr class="odd">
<td align="left">COBRA/other</td>
<td align="left">Consolidated Omnibus Budget Reconciliation Act, which gives some employees the ability to continue health insurance coverage after leaving employment, or other types of insurance.</td>
</tr>
</tbody>
</table>
<p><br></p>
</div>
<div id="knowledge-regarding-smoking-in-our-dataset" class="section level3">
<h3>2. Knowledge regarding <strong>smoking</strong> in our dataset</h3>
<p>Here we conduct some explorations focusing on smoking information in our data. Click on each tab to see different dimensions of smoking data.</p>
<p><br></p>
<div id="smoking-status" class="section level4 tabset">
<h4 class="tabset">Smoking status</h4>
<div id="age-distribution" class="section level5">
<h5>Age distribution</h5>
<pre class="r"><code>smokegroup_count = smoke_df %&gt;% 
  drop_na(smoker) %&gt;% 
  dplyr::group_by(smoker) %&gt;% 
  dplyr::summarize(
    smokegroup_count = n()) %&gt;% 
  pull()

smoke_df %&gt;% 
  drop_na(agegroup) %&gt;% 
  group_by(agegroup,smoker) %&gt;% 
  dplyr::summarize(
    age_count = n()) %&gt;% 
  mutate(smokegroup_count = smokegroup_count,
         age_percent = age_count/smokegroup_count)%&gt;% 
  ggplot(aes(x = smoker, y = age_percent, fill = agegroup)) + 
  geom_bar(stat = &quot;identity&quot;,position = &quot;dodge&quot;) +
    labs(
      x = &#39;Smoking status&#39;,
      y = &#39;Proportion&#39;,
      title = &#39;Age distribution among people in different smoking status&#39;,
      fill = &quot;Age Group&quot; )</code></pre>
<p><img src="exploration_files/figure-html/unnamed-chunk-7-1.png" width="90%" /></p>
<p>There are a total 3652 (12%) current smokers, 6167 (21%) former smokers, and 18693 (66%) people never smoked among all the participants. Most current smokers falls in age 25 to 64 (80%). 84% of the paticipants in age 18-24 filter have never smoked.</p>
<p><br></p>
</div>
<div id="health-self-evaluation" class="section level5">
<h5>Health self-evaluation</h5>
<pre class="r"><code>smoke_df %&gt;% 
  drop_na(generalhealth) %&gt;% 
  dplyr::group_by(generalhealth,smoker) %&gt;% 
  dplyr::summarize(
    count = n())%&gt;% 
  mutate(smokegroup_count = smokegroup_count,
         health_percent = count/smokegroup_count)%&gt;% 
  ggplot(aes(x = smoker, y = health_percent, fill = generalhealth)) + 
  geom_bar(stat = &quot;identity&quot;,position = &quot;dodge&quot;) +
    labs(
      x = &#39;Smoking status&#39;,
      y = &#39;Health self-evaluation \n(% in each types of smoker)&#39;,
      title = &#39;Self-evaluation of health conditions among people in different smoking status\n(% in each types of smoker)&#39;,
      fill = &quot;Health status&quot; )</code></pre>
<p><img src="exploration_files/figure-html/unnamed-chunk-8-1.png" width="90%" /></p>
<p>Compare with other groups, current smokers have lowest proportion of excellent health status(self-evaluated).</p>
<p><br></p>
</div>
<div id="poverty-status" class="section level5">
<h5>Poverty status</h5>
<pre class="r"><code>smoke_df %&gt;% 
  drop_na(poverty_group) %&gt;% 
  dplyr::group_by(poverty_group,smoker) %&gt;% 
  dplyr::summarize(
    count = n()
  ) %&gt;% 
  mutate(
    smokegroup_count = smokegroup_count,
    poverty_percent = count/smokegroup_count) %&gt;% 
  ggplot(aes(x = smoker, y = poverty_percent, fill = poverty_group)) + 
  geom_bar(stat = &quot;identity&quot;,position = &quot;dodge&quot;) +
    labs(
      x = &#39;Smoking status&#39;,
      y = &#39;Poverty groups\n(% in each types of smoker)&#39;,
      title = &#39;Poverty groups (% in each types of smoker)&#39;,
      fill = &quot;Poverty Group&quot; )</code></pre>
<p><img src="exploration_files/figure-html/unnamed-chunk-9-1.png" width="90%" /> Comparing to other groups, current smokers have the largest proportion of people who are &lt;100% FPL, which means unsatisfactory financial status. They also have the least proportion of people who are &gt;600 FPL, indicating atisfactory financial status.</p>
<p><br></p>
</div>
<div id="bmi" class="section level5">
<h5>BMI</h5>
<pre class="r"><code>smoke_df %&gt;% 
  drop_na(bmi,smoker) %&gt;% 
  ggplot(aes(x = smoker, y = bmi,fill = smoker)) + 
  geom_boxplot() +
  ylim(0,50)+
    labs(
      x = &#39;Smoking status&#39;,
      y = &#39;BMI (kg/m^2)&#39;,
      title = &#39;The distribution of bmi among people in different smoking status&#39;) </code></pre>
<pre><code>## Warning: Removed 162 rows containing non-finite values (stat_boxplot).</code></pre>
<p><img src="exploration_files/figure-html/unnamed-chunk-10-1.png" width="90%" /></p>
<p>There’s no significant difference of participants BMI in different smoking status.</p>
<p><br></p>
</div>
</div>
<div id="current-smokers" class="section level4 tabset">
<h4 class="tabset">Current smokers</h4>
<p>Next, we focus on the <strong>current smokers</strong> and look at there smoking intensity, frequency and cost, as well as their BMI index.</p>
<div id="smoking-intensity-and-frequency" class="section level5">
<h5>Smoking intensity and frequency</h5>
<pre class="r"><code>type = current_smoker %&gt;%
  ggplot(aes(x = smoker_cat, fill = everyday))+
  geom_histogram(stat=&quot;count&quot;) +
    labs(
      x = &#39;Smoking intensity&#39;,
      y = &#39;Number of current smokers&#39;,
      title = &#39;Smoking intensity of current smokers&#39;)+
  theme(legend.position = &quot;none&quot;)</code></pre>
<pre class="r"><code>consumption = current_smoker %&gt;% 
  ggplot(aes(x = numberperdaya, fill = everyday)) + 
  geom_histogram()+
  xlim(0,30)+
  labs(
    x = &quot;Average number of cigarattes smoked per day&quot;,
    y = &quot;Number of current smokers&quot;,
    title = &quot;Average number of cigarattes\nsmoked per day&quot;,
    fill = &quot;Smoking frequency&quot;
       )+
  theme(legend.position = &quot;right&quot;)</code></pre>
<p><img src="exploration_files/figure-html/my-chunkn1-1.png" width="90%" /></p>
<p>Most of the current smokers are light smokers. Among those light smokers, nearly half of them smoke everyday, while normal and heavy smokers are more likely to smoke everyday. Casual smokers tend to consume less cigarette than everyday smokers.</p>
<p><br></p>
</div>
<div id="bmi-1" class="section level5">
<h5>BMI</h5>
<pre class="r"><code>current_smoker %&gt;% 
  ggplot(aes(x = smoker_cat, y = bmi, fill = smoker_cat))+
  geom_boxplot() +
  theme(plot.title = element_text(hjust = 0.5)) +
  ylim(0,50)+
  #facet_grid(.~smoker_cat,scales = &quot;free&quot;) +
    labs(
      x = &#39;Smoking intensity&#39;,
      y = &#39;BMI (kg/m^2)&#39;,
      title = &#39;BMI among current smokers with different smoking intensity&#39;,
      color = &quot;Smoking intensity&quot;)</code></pre>
<p><img src="exploration_files/figure-html/unnamed-chunk-14-1.png" width="90%" /></p>
<p>For heavy smokers, their BMI are slightly higher than light smokers and normal smokers.</p>
<p><br></p>
</div>
<div id="cost-on-smoke" class="section level5">
<h5>Cost on smoke</h5>
<pre class="r"><code>current_smoker %&gt;% 
  ggplot(aes(x = numberperdaya, y = cost20cigarettes,color = everyday))+
  geom_point(alpha = .5,size = 3) +
  xlim(0,50)+
  ylim(0,40)+
  theme(plot.title = element_text(hjust = 0.5)) +
  #facet_grid(.~smoker_cat,scales = &quot;free&quot;) +
    labs(
      x = &#39;Number of cigrattes consumed everyday&#39;,
      y = &#39;Cost of every 20 (one pack) cigrattes&#39;,
      title = &#39;Cost of every 20 (one pack) cigrattes\nfor number of cigrattes consumed everyday&#39;,
      color = &quot;Smoking frequency&quot;)</code></pre>
<p><img src="exploration_files/figure-html/unnamed-chunk-15-1.png" width="90%" /></p>
<p>Regardless of smoking frequency and smoking intensity, the cost of each pack of cigarette are even distributed within $0 to $20</p>
<p><br></p>
</div>
</div>
</div>
<div id="explore-relationship-between-insurance-and-target-variables" class="section level3">
<h3>3. Explore relationship between <strong>insurance</strong> and target variables</h3>
<p>In this step, we want to explore more about the relationship between insurance and key variables, including smoking, age, have children or not and BMI. We start by plotting distribution graphs to see the pattern between each groups. And then we conduct statistical tests to evaluate the association and similarity between them.</p>
<p><br></p>
<div id="distributions" class="section level4 tabset">
<h4 class="tabset">Distributions</h4>
<div id="smoking" class="section level5">
<h5>Smoking</h5>
<p><img src="exploration_files/figure-html/my-chunkn-1.png" width="90%" /></p>
<p>We found that, current smokers have the highest uninsured proportion comparing to other groups.</p>
<p>Regardless of the smoking status, most people tend to get employer insurance. For former smokers, a larger proportion of them get the medicare insurance compare to people who never smoke or currently smoke.</p>
<p><br></p>
</div>
<div id="age" class="section level5">
<h5>Age</h5>
<p><img src="exploration_files/figure-html/my-chunkn2-1.png" width="90%" /> For person younger than 65 years old, people tend to get insurance as age increase. Specifically, for those age in the range of 25-64 years old, high proportion of them get <strong>employer</strong> insurance since they are in working age.</p>
<p>For person older than 65 years old, most of them get <strong>Medicare</strong> since Medicare is only provided for people above 65 years old.</p>
<p><br></p>
</div>
<div id="have-children-or-not" class="section level5">
<h5>Have children or not</h5>
<p><img src="exploration_files/figure-html/my-chunkn3-1.png" width="90%" /></p>
<p>We found that for those without children, a larger proportion of them get <strong>Medicare</strong> comparing to those with children.</p>
<p><br></p>
</div>
<div id="bmi-2" class="section level5">
<h5>BMI</h5>
<pre class="r"><code>analyse_bmi_insurancetype = 
  dataset_basic %&gt;%
  drop_na(bmi,insure) 
  
uninsure = analyse_bmi_insurancetype %&gt;% 
  mutate(insure = ifelse(insure == &quot;Uninsured&quot;, &quot;Uninsured&quot;, &quot;Insuredd&quot;))
  
bmi_plot1 = 
  analyse_bmi_insurancetype %&gt;% 
  ggplot(aes(x = insure, y = bmi,fill = insure)) + 
  geom_boxplot(alpha = 0.6) +
    theme(legend.position = &quot;none&quot;) +
    scale_fill_brewer(palette = &quot;Dark2&quot;) +
    labs(
      x = &#39;insurance&#39;,
      y = &#39;bmi&#39;,
      title = &#39;The distribution of bmi in groups\nhaving different insurance type&#39;) +
  coord_flip()


bmi_plot2 = 
  uninsure %&gt;% 
  ggplot(aes(x = insure , y = bmi, fill = insure)) + 
  geom_boxplot(alpha = 0.6) +
    theme(legend.position = &quot;none&quot;) +
    scale_fill_brewer(palette = &quot;Dark2&quot;) +
    labs(
      x = &#39;have insurance or not&#39;,
      y = &#39;bmi&#39;,
      title = &#39;The distribution of bmi in groups\nhaving insurance or not&#39;) +
  coord_flip()

bmi_plot2 + bmi_plot1</code></pre>
<p><img src="exploration_files/figure-html/unnamed-chunk-19-1.png" width="90%" /></p>
<p>We did not observe significant difference between each group.</p>
<p><br></p>
</div>
</div>
<div id="statistical-test" class="section level4 tabset">
<h4 class="tabset">Statistical test</h4>
<div id="smoking-1" class="section level5">
<h5>Smoking</h5>
<div id="chi-quare-test-between-insurance-type-and-smoking" class="section level6">
<h6><strong>Chi-quare test between insurance type and smoking</strong></h6>
<p><span class="math inline">\(H_0\)</span> : insurance type and smoking are independent, there is no relationship between the two categorical variables.</p>
<p><span class="math inline">\(H_1\)</span> : insurance type and smoking are dependent, there is a relationship between the two categorical variables.</p>
<p><em>Test result:</em></p>
<pre class="r"><code>dat = 
  dataset_basic %&gt;%
  drop_na(smoker,insure) </code></pre>
<p><img src="exploration_files/figure-html/my-chunk1-1.png" width="90%" /></p>
<p>We reject <span class="math inline">\(H_0\)</span> and then conclude that insurance type and smoking are dependent.</p>
</div>
</div>
<div id="age-1" class="section level5">
<h5>Age</h5>
<div id="chi-quare-test-between-insurance-type-and-age" class="section level6">
<h6><strong>Chi-quare test between insurance type and age</strong></h6>
<p><span class="math inline">\(H_0\)</span> : insurance type and age are independent, there is no relationship between the two categorical variables.</p>
<p><span class="math inline">\(H_1\)</span> : insurance type and age are dependent, there is a relationship between the two categorical variables.</p>
<p><em>Test result:</em></p>
<pre class="r"><code>dat = 
  dataset_basic %&gt;%
  drop_na(agegroup,insure) </code></pre>
<p><img src="exploration_files/figure-html/my-chunk2-1.png" width="90%" /></p>
<p>We reject <span class="math inline">\(H_0\)</span> and then conclude that insurance type and age are dependent.</p>
</div>
</div>
<div id="have-children-or-not-1" class="section level5">
<h5>Have children or not</h5>
<div id="chi-quare-test-between-insurance-type-and-children" class="section level6">
<h6><strong>Chi-quare test between insurance type and children</strong></h6>
<p><span class="math inline">\(H_0\)</span> : insurance type and have children or not are independent, there is no relationship between the two categorical variables.</p>
<p><span class="math inline">\(H_1\)</span> : insurance type and have children or not are dependent, there is a relationship between the two categorical variables.</p>
<p><em>Test result:</em></p>
<pre class="r"><code>#test_data_smoke_insurancetype = analyse_smoke_insurancetype %&gt;% 
#  pivot_wider(
#  names_from = &quot;Insured&quot;, 
#  values_from = &quot;n&quot;)

#test_data_smoke_insurancetype %&gt;% knitr::kable()
#chisq.test(test_data_smoke_insurancetype[-1])

dat = 
  dataset_basic %&gt;%
  drop_na(child,insure)</code></pre>
<p><img src="exploration_files/figure-html/my-chunk3-1.png" width="90%" /></p>
<p>We reject <span class="math inline">\(H_0\)</span> and then conclude that insurance type and children are dependent.</p>
</div>
</div>
<div id="bmi-3" class="section level5">
<h5>BMI</h5>
<div id="anova-test-between-insurance-type-and-bmi" class="section level6">
<h6><strong>ANOVA test between insurance type and BMI</strong></h6>
<p><span class="math inline">\(H_0\)</span> : The mean of BMI in each insurance type groups are the same</p>
<p><span class="math inline">\(H_1\)</span> : At least two means of BMI in all insurance type groups are different</p>
<p><em>Test result:</em></p>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">df</th>
<th align="right">sumsq</th>
<th align="right">meansq</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">insure</td>
<td align="right">6</td>
<td align="right">2435.492</td>
<td align="right">405.9154</td>
<td align="right">10.88312</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">Residuals</td>
<td align="right">26917</td>
<td align="right">1003942.322</td>
<td align="right">37.2977</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
</tbody>
</table>
<p><img src="exploration_files/figure-html/my-chunk6-1.png" width="90%" /></p>
<p>According to the ANOVA test, we reject <span class="math inline">\(H_0\)</span> and conclude At least two means of BMI in all insurance type groups are different. Detailed information of the difference in each group can be seen on the above image.</p>
<p><br></p>
</div>
</div>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
